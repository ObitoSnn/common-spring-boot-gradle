task printTree {
    doLast {
        println '+--  ' + rootProject.name
        printProjectTree(rootProject.childProjects)
    }
}

/**
 * 打印工程目录树
 *
 * @param dirs childProjects，key:project的名称，value:project对象
 */
def printProjectTree(Map<String, Project> dirs) {
    if (dirs.size() > 0) {
        dirs.values().forEach(project -> {
            boolean hasChild = project.childProjects.values().size() > 0
            def startStr = !hasChild ? '\\--' : '+--'
            println generatorTreeNodePrefix(project.depth, startStr) + project.name
            if (hasChild) {
                printProjectTree(project.childProjects)
            }
        })
    }
}

/**
 * 自动根据层级深度生成占位符
 *
 * @param depth project深度
 */
def generatorTreeNodePrefix(int depth, String startStr) {
    def s = '|   '
    for (int i = 0; i < depth; i++) {
        if (i == 0) {
            s += startStr
        } else {
            s += '--'
        }
    }
    return s + ' '
}
